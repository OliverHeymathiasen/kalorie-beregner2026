<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kalorieberegner</title>
  <style>
    :root{
      --bg:#f5f6fb;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --brand:#6d5efc;
      --border:#e2e8f0;
      --shadow: 0 10px 30px rgba(15,23,42,.08);
      --radius:16px;
    }
    body{ margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; background:var(--bg); color:var(--text); }
    .wrap{ max-width:520px; margin:0 auto; padding:18px 16px 40px; }
    .header{ display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px; }
    .pill{ border:1px solid var(--border); background:#f1efff; color:var(--brand); border-radius:999px; padding:10px 14px; font-weight:700; }
    .card{ background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); padding:18px; }
    h1{ margin:6px 0 4px; font-size:30px; letter-spacing:-.02em; }
    .sub{ margin:0 0 16px; color:var(--muted); font-size:14px; }
    .step{ display:none; }
    .step.active{ display:block; }
    .grid{ display:grid; gap:12px; }
    .choice{ display:flex; align-items:center; justify-content:space-between; gap:10px; border:2px solid var(--border);
      border-radius:14px; padding:14px; cursor:pointer; user-select:none; background:#fff; }
    .choice .title{ font-weight:900; }
    .choice .desc{ color:var(--muted); font-size:13px; margin-top:2px; }
    .choice.selected{ border-color:var(--brand); background:#f2f0ff; }
    .two{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
    .sliderRow{ border:1px solid var(--border); border-radius:14px; padding:12px; background:#fff; }
    .sliderTop{ display:flex; align-items:baseline; justify-content:space-between; gap:12px; margin-bottom:8px; }
    .label{ font-weight:900; }
    .val{ color:var(--brand); font-weight:1000; font-size:18px; white-space:nowrap; }
    input[type="range"]{ width:100%; accent-color:var(--brand); }
    .btnRow{ display:flex; gap:10px; margin-top:14px; }
    button{ width:100%; border:0; border-radius:14px; padding:14px 16px; font-weight:1000; font-size:16px; cursor:pointer; }
    .primary{ background:var(--brand); color:#fff; }
    .ghost{ background:#eef2ff; color:#1f2a44; }
    .resultsBar{ display:grid; grid-template-columns:1fr 1fr; gap:10px; margin:10px 0 14px; }
    .resultBox{ border-radius:14px; padding:14px; background:#f2f0ff; border:1px solid #e7e4ff; }
    .resultBox .k{ color:var(--muted); font-size:13px; font-weight:800; margin-bottom:6px; }
    .resultBox .v{ font-size:28px; font-weight:1100; color:var(--brand); letter-spacing:-.02em; }
    .note{ color:var(--muted); font-size:14px; line-height:1.45; }
    .mc{ margin-top:14px; border-top:1px solid var(--border); padding-top:14px; }
    .mc input[type="text"], .mc input[type="email"]{
      width:100%; box-sizing:border-box; border:1px solid var(--border); border-radius:12px;
      padding:12px; font-size:15px; margin-bottom:10px;
    }
    .mc .consent{ display:flex; gap:10px; align-items:flex-start; font-size:13px; color:var(--muted); margin:8px 0 14px; }
    .tiny{ font-size:12px; color:var(--muted); margin-top:10px; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="header">
      <div style="font-weight:1000; color:var(--brand);">Kalorieberegner</div>
      <div class="pill">Gratis</div>
    </div>

    <div class="card">
      <h1>Macro Calculator</h1>
      <p class="sub">Sliders → beregn → få din gennemgang på mail</p>

      <!-- STEP 1 -->
      <section class="step active" data-step="1">
        <div class="grid">
          <div style="font-weight:1000;">Jeg vil gerne…</div>

          <div class="choice selected" data-goal="maintain">
            <div>
              <div class="title">Perform Better</div>
              <div class="desc">Vedligehold / performance</div>
            </div>
            <div>›</div>
          </div>

          <div class="choice" data-goal="gain">
            <div>
              <div class="title">Gain Muscle</div>
              <div class="desc">Muskelopbygning</div>
            </div>
            <div>›</div>
          </div>

          <div class="choice" data-goal="lose">
            <div>
              <div class="title">Lose Fat</div>
              <div class="desc">Fedt tab</div>
            </div>
            <div>›</div>
          </div>

          <div class="btnRow">
            <button class="primary" id="to2">Next</button>
          </div>
        </div>
      </section>

      <!-- STEP 2 -->
      <section class="step" data-step="2">
        <div class="grid">
          <div class="two">
            <div class="choice selected" data-sex="female">
              <div><div class="title">Female</div><div class="desc">Køn</div></div>
            </div>
            <div class="choice" data-sex="male">
              <div><div class="title">Male</div><div class="desc">Køn</div></div>
            </div>
          </div>

          <div class="sliderRow">
            <div class="sliderTop"><div class="label">Alder</div><div class="val"><span id="ageOut">35</span> år</div></div>
            <input id="age" type="range" min="16" max="80" value="35" />
          </div>

          <div class="sliderRow">
            <div class="sliderTop"><div class="label">Højde</div><div class="val"><span id="heightOut">170</span> cm</div></div>
            <input id="height" type="range" min="140" max="210" value="170" />
          </div>

          <div class="sliderRow">
            <div class="sliderTop"><div class="label">Vægt</div><div class="val"><span id="weightOut">100</span> kg</div></div>
            <input id="weight" type="range" min="40" max="200" value="100" />
          </div>

          <div class="btnRow">
            <button class="ghost" data-back type="button">Back</button>
            <button class="primary" id="to3" type="button">Next</button>
          </div>
        </div>
      </section>

      <!-- STEP 3 -->
      <section class="step" data-step="3">
        <div class="grid">
          <div style="font-weight:1000;">Aktivitetsniveau</div>

          <div class="choice selected" data-activity="1.375">
            <div><div class="title">Lightly active</div><div class="desc">1–3 træninger/uge</div></div><div>›</div>
          </div>
          <div class="choice" data-activity="1.55">
            <div><div class="title">Moderately active</div><div class="desc">3–5 træninger/uge</div></div><div>›</div>
          </div>
          <div class="choice" data-activity="1.725">
            <div><div class="title">Very active</div><div class="desc">6–7 træninger/uge</div></div><div>›</div>
          </div>
          <div class="choice" data-activity="1.9">
            <div><div class="title">Extra active</div><div class="desc">Fysisk job / 2 pas</div></div><div>›</div>
          </div>

          <div class="btnRow">
            <button class="ghost" data-back type="button">Back</button>
            <button class="primary" id="calc" type="button">Calculate</button>
          </div>
        </div>
      </section>

      <!-- STEP 4 -->
      <section class="step" data-step="4">
        <div class="resultsBar">
          <div class="resultBox">
            <div class="k">Calories target</div>
            <div class="v"><span id="calOut">0</span></div>
          </div>
          <div class="resultBox">
            <div class="k">Protein target</div>
            <div class="v"><span id="protOut">0</span>g</div>
          </div>
        </div>

        <div class="grid">
          <div class="sliderRow">
            <div class="sliderTop"><div class="label">Protein pr. kg</div><div class="val"><span id="ppkOut">1.5</span> g</div></div>
            <input id="ppk" type="range" min="1.2" max="2.2" step="0.1" value="1.5" />
          </div>

          <div class="sliderRow">
            <div class="sliderTop"><div class="label" id="defLabel">Kalorie deficit</div><div class="val"><span id="defOut">15</span>%</div></div>
            <input id="def" type="range" min="0" max="30" step="1" value="15" />
          </div>

          <div class="note">
            <strong>Få din gennemgang på mail</strong><br>
            Jeg sender dig din anbefaling + hvad du skal gøre herfra (med dine tal).
          </div>

          <div class="mc">
            <!-- VIGTIGT: Udskift action URL med din Mailchimp -->
            <form id="mcForm"
              action="https://REPLACE_WITH_YOUR_MAILCHIMP_FORM_ACTION_URL"
              method="post" target="_blank" novalidate>

              <input type="text" name="FNAME" placeholder="Fornavn" />
              <input type="email" name="EMAIL" placeholder="Email" required />

              <!-- Hidden merge fields: skal oprettes i Mailchimp -->
              <input type="hidden" name="CALS" id="mcCals" />
              <input type="hidden" name="PROT" id="mcProt" />
              <input type="hidden" name="FATS" id="mcFats" />
              <input type="hidden" name="CARBS" id="mcCarbs" />
              <input type="hidden" name="GOAL" id="mcGoal" />

              <label class="consent">
                <input type="checkbox" required />
                <span>Jeg accepterer at modtage email med mit resultat og opfølgning.</span>
              </label>

              <div class="btnRow">
                <button class="ghost" data-back type="button">Back</button>
                <button class="primary" type="submit">Send</button>
              </div>

              <div class="tiny">Tip: Tjek din spam/promotions første gang.</div>
            </form>
          </div>
        </div>
      </section>

    </div>
  </div>

  <script>
    const state = {
      goal: "maintain",
      sex: "female",
      age: 35,
      height: 170,
      weight: 100,
      activity: 1.375,
      ppk: 1.5,
      adjustPct: 15, // deficit or surplus depending on goal
      calories: 0, protein: 0, fats: 0, carbs: 0
    };

    const $ = (s, r=document) => r.querySelector(s);
    const $$ = (s, r=document) => Array.from(r.querySelectorAll(s));

    function showStep(n){
      $$(".step").forEach(s => s.classList.remove("active"));
      $(`.step[data-step="${n}"]`).classList.add("active");
    }
    function selectChoice(groupSel, el){
      $$(groupSel).forEach(x => x.classList.remove("selected"));
      el.classList.add("selected");
    }
    function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

    // Revised Harris-Benedict (Roza & Shizgal)
    function bmr({sex, weight, height, age}){
      if(sex === "male") return 88.362 + (13.397*weight) + (4.799*height) - (5.677*age);
      return 447.593 + (9.247*weight) + (3.098*height) - (4.330*age);
    }

    function syncUI(){
      $("#ageOut").textContent = state.age;
      $("#heightOut").textContent = state.height;
      $("#weightOut").textContent = state.weight;
      $("#ppkOut").textContent = state.ppk.toFixed(1);
      $("#defOut").textContent = state.adjustPct;

      const l = $("#defLabel");
      if(state.goal === "gain") l.textContent = "Kalorie surplus";
      else if(state.goal === "lose") l.textContent = "Kalorie deficit";
      else l.textContent = "Kalorie justering";
    }

    function compute(){
      const tdee = bmr(state) * state.activity;

      let target = tdee;
      if(state.goal === "lose") target = tdee * (1 - state.adjustPct/100);
      if(state.goal === "gain") target = tdee * (1 + state.adjustPct/100);
      if(state.goal === "maintain") target = tdee * (1 - state.adjustPct/100);

      const protein = state.weight * state.ppk;
      const fats = state.weight * 0.8;
      const carbs = clamp((target - protein*4 - fats*9) / 4, 0, 9999);

      state.calories = Math.round(target);
      state.protein = Math.round(protein);
      state.fats = Math.round(fats);
      state.carbs = Math.round(carbs);

      $("#calOut").textContent = state.calories;
      $("#protOut").textContent = state.protein;

      // push to Mailchimp hidden fields
      $("#mcCals").value = String(state.calories);
      $("#mcProt").value = String(state.protein);
      $("#mcFats").value = String(state.fats);
      $("#mcCarbs").value = String(state.carbs);
      $("#mcGoal").value = state.goal;
    }

    // Step 1 selections
    $$(".step[data-step='1'] .choice").forEach(el => {
      el.addEventListener("click", () => {
        selectChoice(".step[data-step='1'] .choice", el);
        state.goal = el.dataset.goal;
        // defaults
        if(state.goal === "lose") state.adjustPct = 15;
        if(state.goal === "gain") state.adjustPct = 10;
        if(state.goal === "maintain") state.adjustPct = 0;
        $("#def").value = String(state.adjustPct);
        syncUI();
      });
    });
    $("#to2").addEventListener("click", () => showStep(2));

    // Step 2 selections
    $$(".step[data-step='2'] .choice[data-sex]").forEach(el => {
      el.addEventListener("click", () => {
        selectChoice(".step[data-step='2'] .choice[data-sex]", el);
        state.sex = el.dataset.sex;
      });
    });
    $("#age").addEventListener("input", e => { state.age = +e.target.value; syncUI(); });
    $("#height").addEventListener("input", e => { state.height = +e.target.value; syncUI(); });
    $("#weight").addEventListener("input", e => { state.weight = +e.target.value; syncUI(); });
    $("#to3").addEventListener("click", () => showStep(3));

    // Step 3 selections
    $$(".step[data-step='3'] .choice[data-activity]").forEach(el => {
      el.addEventListener("click", () => {
        selectChoice(".step[data-step='3'] .choice[data-activity]", el);
        state.activity = Number(el.dataset.activity);
      });
    });
    $("#calc").addEventListener("click", () => { compute(); syncUI(); showStep(4); });

    // Step 4 sliders
    $("#ppk").addEventListener("input", e => { state.ppk = +e.target.value; syncUI(); compute(); });
    $("#def").addEventListener("input", e => { state.adjustPct = +e.target.value; syncUI(); compute(); });

    // Back buttons
    $$("[data-back]").forEach(btn => btn.addEventListener("click", () => {
      const cur = Number($(".step.active").dataset.step);
      showStep(Math.max(1, cur - 1));
    }));

    // Ensure hidden fields are updated on submit too
    $("#mcForm").addEventListener("submit", () => compute());

    syncUI();
  </script>
</body>
</html>
